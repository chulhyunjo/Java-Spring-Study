# 02. 조회대상 빈이 2개 이상일 경우

- @Autowired 필드 명 매칭
- @Qualifier-> @Qualifier끼리 매칭 -> 빈 이름 매칭
- @Primary 사용



> @Autowired 필드 명 매칭

- `@Autowired`는 타입 매칭을 시도하고, 이때 여러 빈이 있으면 필드 이름(파라미터 이름)으로 빈 이름을 추가 매칭

```java
@Autowired
private DiscountPolicy rateDiscountPolicy
```

- 필드 명이 `rateDiscountPolicy`이므로 정상 주입된다.
  - 필드 명 매칭은 먼저 타입 매칭을 시도하고 그 결과에 여러 빈이 있을 때 추가로 동작하는 기능이다.



> @Qualifier

```java
@Component
@Qualifier("fixDiscountPolicy")
public class FixDiscountPolicy implements DiscountPolicy
    
@Component
@Qualifier("mainDiscountPolicy")
public class RateDiscountPolicy implements DiscountPolicy
```

- @Qualifier 끼리 매칭
- 빈 이름 배칭
- `NoSuchBeanDefinitionException` 예외 발생



> @Primary 사용

`@Primary`는 우선순위를 정하는 방법이다. @Autowired 시에 여러 빈 매칭되면 `@Primary`가 우선권을 가짐

```java
@Component
@Primary
public class RateDiscountPolicy implements DiscountPolicy{
```



> @Primary, @Qualifier 활용

코드에서 자주 사용하는 메인 데이터베이스의 커넥션을 획득하는 스프링 빈이 있고, 코드에서 특별한 기능으로 가끔 사용하는 서브 데이터베이스의 커넥션을 획득하는 스프링 빈이 있다고 생각해보자. 메인 데이터베이스의 커넥션을 획득하는 스프링 빈은 `@Primary`를 적용해서 조회하는 곳에서 `@Qualifier` 지정 없이 편리하게 조회하고, 서브 데이터 베이스 커넥션 빈을 획득 할 때는 `@Qualifier`를 지정해서 명시적으로 획득하는 방식으로 사용하면 코드를 깔끔하게 유지할 수 있다. 물론 메인 데이터베이스의 스프링 빈을 등록할 때 `@Qualifier`를 지정해주는 것은 상관 X



> 우선순위

`@Primary`는 기본값 처럼 동작하는 것이고, `Qualifier`는 매우 상세하게 동작한다. 이런 경우 어떤 것이 우선권을 가져갈까? 스프링은 자동보다는 수동이, 넓은 범위의 선택권 보다는 좁은 범위의 선택권이 우선 순위가 높다. 따라서 여기서도 `@Qualifier`가 우선권이 높다